import os

import subprocess

 

def scan_vulnerabilities(ip):

    if not ip:

        print("No IP address provided.")

        return

 

    try:

        command = f'nmap -p- -sC -sV --script vuln {ip}'

        process = subprocess.Popen(command, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)

        output, error = process.communicate()

       

        if process.returncode != 0:

            print("Error during the scan:")

            print(error.decode())

            return

       

        print("Scan Results:\n")

        print(output.decode())

       

    except Exception as e:

        print(f"An error occurred: {e}")

 

if __name__ == "__main__":

    target_ip = input("Enter the target IP address: ")

    scan_vulnerabilities(target_ip)
